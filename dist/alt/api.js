alt.loader.api=function(){return"undefined"!=typeof alt.modules.api?alt.modules.api:(alt.api={isenabled:!0},alt.modules.api=angular.module("alt-api",[]).config(["$provide","$httpProvider",function(e,t){if(alt.api.isenabled){t.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded";var a=null;e.factory("httpInterceptor",["$log","$q","$window",function(e,t,n){return{request:function(e){if(!alt.api.isenabled)return e;if(a=a||e.transformRequest,e.headers["Content-Type"])if(0===e.headers["Content-Type"].indexOf("application/x-www-form-urlencoded")){var t=[],n=function(e,t){if("$$hashKey"==e)return"";var a;switch(typeof t){case"string":case"number":case"boolean":return e+"="+encodeURIComponent(t);case"object":case"array":return a=[],angular.forEach(t,function(t,r){a.push(n(e+"["+r+"]",t))}),a.join("&")}};for(var r in e.data)e.data.hasOwnProperty(r)&&"$$hashKey"!=r&&t.push(n(r,e.data[r]));e.transformRequest=a,e.data=t.join("&")}else 0==e.headers["Content-Type"].indexOf("multipart/form-data")&&(e.transformRequest=[function(t){var a=new FormData,n=function(e,t,a){if("$$hashKey"==t)return"";switch(typeof a){case"string":case"number":e.append(t,a);break;case"object":if("undefined"!=typeof File&&a instanceof File)e.append(t,a);else if("undefined"==typeof File&&"undefined"!=typeof a.name)e.append(t,a);else for(var r in a)a.hasOwnProperty(r)&&"$$hashKey"!=r&&n(e,t+"["+r+"]",a[r]);break;case"array":for(var r=0;r<a.length;r++)n(e,t+"["+r+"]",a[r])}};for(var r in e.data)e.data.hasOwnProperty(r)&&"$$hashKey"!=r&&n(a,r,e.data[r]);return a}],delete e.headers["Content-Type"]);return e.timeout=alt.timeout||1e4,e},response:function(e){if(!alt.api.isenabled)return e;var a={};try{a=angular.copy(e)}catch(r){}if("object"==typeof e.data){if(e.data=e.data||{},a.version=e.data.v||100,a.code=e.data.s||e.data.c||e.data.code||e.status||200,a.status=a.code,a.data=e.data.d||e.data.data||e.data,a.message=e.data.m||e.data.msg||e.data,a.time=e.data.t||0,a.usage=e.data.u||"",a.token=e.data.token||e.token||"",200!=a.status)return 401==a.status?(n.location.href=alt.baseUrl+"auth/login",t.reject(a)):(a.message=a.message||"Gagal terhubung ke server",t.reject(a))}else if(0===e.config.url.indexOf(alt.serverUrl)&&200!=e.status&&"object"!=typeof e.data)return a.code=-1,a.status=a.code,a.message="Tidak dapat terhubung ke server","development"==alt.environment.toLowerCase()&&(a.message+="<br/>"+e.data),t.reject(a);return a}}}]),t.interceptors.push("httpInterceptor")}}]).factory("$api",["$http","$log","$q",function(e,t,a){return function(t,n,r){t=t||"";var o=t.split("/");return n=n||o[o.length-1]+"id",t=(0!==t.indexOf(alt.serverUrl)?alt.serverUrl:"")+t,r=alt.extend({connect:function(){return!0},success:function(){return!0},error:function(){return!0}},r),{url:t,pkey:n,config:r,connect:function(n,o,i){n=n||"",n=(0!==n.indexOf("/")?"/":"")+n,o=o||{},i=alt.extend({skipAuthorization:!1,ismultipart:!1,method:"POST"},i);var s=a.defer(),u=!1,c=s.promise,d=a.defer(),f={headers:{"Content-Type":i.ismultipart?"multipart/form-data":i.contenttype?i.contenttype:"application/x-www-form-urlencoded"},skipAuthorization:i.skipAuthorization,method:i.method,data:o,url:t+n,timeout:d.promise};return r.connect(f)!==!1?e(f).then(function(e){r.success(e,f,s,u)!==!1&&s.resolve(e,f,s,u)},function(e){r.error(e,f,s,u)!==!1&&s.reject(e,f,s,u)}):r.error({message:"Tidak dapat terhubung"},f,s,u)!==!1&&s.reject({message:"Tidak dapat terhubung"},f,s,u),c.abort=function(){u=!0,d.resolve()},c},count:function(e,t){return this.connect("count",e,t)},list:function(e,t){return this.connect("list",e,t)},retrieve:function(e,t,a){if(e=e||"",t=t||{},"object"==typeof e)try{t=angular.copy(e)}catch(r){t=e}else t[n]=e;return this.connect("retrieve",t,a)},keyvalues:function(e,t){return this.connect("keyvalues",e,t)},insert:function(e,t){return this.connect("insert",e,t)},update:function(e,t){return this.connect("update",e,t)},remove:function(e,t,a){if(e=e||"",t=t||{},"object"==typeof e)try{t=angular.copy(e)}catch(r){t=e}else t[n]=e;return this.connect("delete",t,a)},isexist:function(e,t){return this.connect("is_exist",e,t)}}}}]),void alt.module("alt-api",alt.modules.api))},"undefined"!=typeof define?define([],function(){alt.loader.api()}):alt.loader.api();